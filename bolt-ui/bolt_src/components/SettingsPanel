<div class="settings-panel">
  <div class="panel-header">
    <h3 class="panel-title">Impostazioni</h3>
    <div class="panel-actions">
      <button class="action-btn reset-btn" aria-label="Reimposta impostazioni">
        ‚Üª Reset
      </button>
      <button class="action-btn save-btn" aria-label="Salva impostazioni">
        üíæ Salva
      </button>
    </div>
  </div>
  
  <div class="settings-container">
    <div class="settings-section active" data-section="general">
      <h4>Impostazioni Generali</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="autoSave" class="setting-label">Salvataggio Automatico</label>
            <span class="setting-description">Salva automaticamente il progresso di gioco</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="autoSave" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="autoSaveInterval" class="setting-label">Intervallo Autosave</label>
            <span class="setting-description">Frequenza del salvataggio automatico</span>
          </div>
          <div class="setting-control">
            <select id="autoSaveInterval" class="setting-select">
              <option value="5">5 minuti</option>
              <option value="10" selected>10 minuti</option>
              <option value="15">15 minuti</option>
              <option value="30">30 minuti</option>
            </select>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="confirmActions" class="setting-label">Conferma Azioni</label>
            <span class="setting-description">Richiedi conferma per azioni importanti</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="confirmActions" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
      
      <div class="settings-group">
        <h5>Interfaccia</h5>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="showTutorials" class="setting-label">Mostra Tutorial</label>
            <span class="setting-description">Mostra suggerimenti e guide</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="showTutorials" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="interfaceDensity" class="setting-label">Densit√† Interfaccia</label>
            <span class="setting-description">Spazio tra gli elementi dell'interfaccia</span>
          </div>
          <div class="setting-control">
            <select id="interfaceDensity" class="setting-select">
              <option value="compact">Compatta</option>
              <option value="normal" selected>Normale</option>
              <option value="comfortable">Comoda</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="appearance">
      <h4>Aspetto</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="theme" class="setting-label">Tema</label>
            <span class="setting-description">Tema dell'interfaccia</span>
          </div>
          <div class="setting-control">
            <select id="theme" class="setting-select">
              <option value="light">Chiaro</option>
              <option value="dark">Scuro</option>
              <option value="auto" selected>Auto (sistema)</option>
            </select>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="accentColor" class="setting-label">Colore Accent</label>
            <span class="setting-description">Colore principale dell'interfaccia</span>
          </div>
          <div class="setting-control">
            <select id="accentColor" class="setting-select">
              <option value="blue" selected>Blu</option>
              <option value="green">Verde</option>
              <option value="purple">Viola</option>
              <option value="orange">Arancione</option>
              <option value="red">Rosso</option>
            </select>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="fontSize" class="setting-label">Dimensione Testo</label>
            <span class="setting-description">Dimensione del testo nell'interfaccia</span>
          </div>
          <div class="setting-control">
            <select id="fontSize" class="setting-select">
              <option value="small">Piccolo</option>
              <option value="medium" selected>Medio</option>
              <option value="large">Grande</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="settings-group">
        <h5>Animazioni</h5>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="enableAnimations" class="setting-label">Abilita Animazioni</label>
            <span class="setting-description">Attiva le animazioni dell'interfaccia</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="enableAnimations" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="animationSpeed" class="setting-label">Velocit√† Animazioni</label>
            <span class="setting-description">Velocit√† delle animazioni</span>
          </div>
          <div class="setting-control">
            <select id="animationSpeed" class="setting-select">
              <option value="slow">Lenta</option>
              <option value="normal" selected>Normale</option>
              <option value="fast">Veloce</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="gameplay">
      <h4>Gameplay</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="difficulty" class="setting-label">Difficolt√†</label>
            <span class="setting-description">Livello di difficolt√† del gioco</span>
          </div>
          <div class="setting-control">
            <select id="difficulty" class="setting-select">
              <option value="easy">Facile</option>
              <option value="normal" selected>Normale</option>
              <option value="hard">Difficile</option>
              <option value="expert">Esperto</option>
            </select>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="matchSpeed" class="setting-label">Velocit√† Partite</label>
            <span class="setting-description">Velocit√† predefinita simulazione partite</span>
          </div>
          <div class="setting-control">
            <select id="matchSpeed" class="setting-select">
              <option value="slow">Lenta</option>
              <option value="normal" selected>Normale</option>
              <option value="fast">Veloce</option>
              <option value="instant">Istantanea</option>
            </select>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="autoAdvance" class="setting-label">Avanzamento Automatico</label>
            <span class="setting-description">Avanza automaticamente al giorno successivo</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="autoAdvance">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
      
      <div class="settings-group">
        <h5>Simulazione</h5>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="matchDetail" class="setting-label">Dettaglio Partite</label>
            <span class="setting-description">Livello di dettaglio nella simulazione</span>
          </div>
          <div class="setting-control">
            <select id="matchDetail" class="setting-select">
              <option value="low">Basso</option>
              <option value="medium" selected>Medio</option>
              <option value="high">Alto</option>
            </select>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="realism" class="setting-label">Realismo</label>
            <span class="setting-description">Livello di realismo della simulazione</span>
          </div>
          <div class="setting-control">
            <select id="realism" class="setting-select">
              <option value="arcade">Arcade</option>
              <option value="balanced" selected>Bilanciato</option>
              <option value="simulation">Simulazione</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="audio">
      <h4>Audio</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="masterVolume" class="setting-label">Volume Generale</label>
            <span class="setting-description">Volume complessivo del gioco</span>
          </div>
          <div class="setting-control">
            <input type="range" id="masterVolume" class="setting-slider" min="0" max="100" value="80">
            <span class="slider-value">80%</span>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="musicVolume" class="setting-label">Volume Musica</label>
            <span class="setting-description">Volume della musica di sottofondo</span>
          </div>
          <div class="setting-control">
            <input type="range" id="musicVolume" class="setting-slider" min="0" max="100" value="60">
            <span class="slider-value">60%</span>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="sfxVolume" class="setting-label">Volume Effetti</label>
            <span class="setting-description">Volume degli effetti sonori</span>
          </div>
          <div class="setting-control">
            <input type="range" id="sfxVolume" class="setting-slider" min="0" max="100" value="70">
            <span class="slider-value">70%</span>
          </div>
        </div>
      </div>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="enableMusic" class="setting-label">Abilita Musica</label>
            <span class="setting-description">Attiva/disattiva la musica di sottofondo</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="enableMusic" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="enableSfx" class="setting-label">Abilita Effetti</label>
            <span class="setting-description">Attiva/disattiva gli effetti sonori</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="enableSfx" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="notifications">
      <h4>Notifiche</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="enableNotifications" class="setting-label">Abilita Notifiche</label>
            <span class="setting-description">Attiva/disattiva tutte le notifiche</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="enableNotifications" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
      
      <div class="settings-group">
        <h5>Tipi di Notifiche</h5>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="matchNotifications" class="setting-label">Partite</label>
            <span class="setting-description">Notifiche relative alle partite</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="matchNotifications" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="transferNotifications" class="setting-label">Trasferimenti</label>
            <span class="setting-description">Notifiche relative al mercato</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="transferNotifications" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="injuryNotifications" class="setting-label">Infortuni</label>
            <span class="setting-description">Notifiche relative agli infortuni</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="injuryNotifications" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="newsNotifications" class="setting-label">Notizie</label>
            <span class="setting-description">Notifiche relative alle notizie</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="newsNotifications" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="accessibility">
      <h4>Accessibilit√†</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="highContrast" class="setting-label">Alto Contrasto</label>
            <span class="setting-description">Aumenta il contrasto per una migliore leggibilit√†</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="highContrast">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="reduceMotion" class="setting-label">Riduci Movimento</label>
            <span class="setting-description">Riduce o elimina le animazioni</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="reduceMotion">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="textSize" class="setting-label">Dimensione Testo</label>
            <span class="setting-description">Dimensione del testo nell'interfaccia</span>
          </div>
          <div class="setting-control">
            <select id="textSize" class="setting-select">
              <option value="normal" selected>Normale</option>
              <option value="large">Grande</option>
              <option value="x-large">Molto Grande</option>
            </select>
          </div>
        </div>
      </div>
      
      <div class="settings-group">
        <h5>Supporto Screen Reader</h5>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="enhancedDescriptions" class="setting-label">Descrizioni Migliorate</label>
            <span class="setting-description">Descrizioni pi√π dettagliate per screen reader</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="enhancedDescriptions">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label for="focusHighlight" class="setting-label">Evidenzia Focus</label>
            <span class="setting-description">Rende pi√π visibile l'elemento con focus</span>
          </div>
          <div class="setting-control">
            <label class="toggle-switch">
              <input type="checkbox" id="focusHighlight" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="language">
      <h4>Lingua</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label for="language" class="setting-label">Lingua</label>
            <span class="setting-description">Lingua dell'interfaccia</span>
          </div>
          <div class="setting-control">
            <select id="language" class="setting-select">
              <option value="it" selected>Italiano</option>
              <option value="en">English</option>
              <option value="es">Espa√±ol</option>
              <option value="fr">Fran√ßais</option>
              <option value="de">Deutsch</option>
            </select>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="data">
      <h4>Dati</h4>
      
      <div class="settings-group">
        <div class="setting-item">
          <div class="setting-info">
            <label class="setting-label">Esporta Impostazioni</label>
            <span class="setting-description">Esporta le impostazioni in un file</span>
          </div>
          <div class="setting-control">
            <button class="button button-secondary export-settings-btn">
              Esporta
            </button>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label class="setting-label">Importa Impostazioni</label>
            <span class="setting-description">Importa le impostazioni da un file</span>
          </div>
          <div class="setting-control">
            <button class="button button-secondary import-settings-btn">
              Importa
            </button>
          </div>
        </div>
        
        <div class="setting-item">
          <div class="setting-info">
            <label class="setting-label">Reimposta Impostazioni</label>
            <span class="setting-description">Ripristina tutte le impostazioni ai valori predefiniti</span>
          </div>
          <div class="setting-control">
            <button class="button button-warning reset-all-btn">
              Reimposta
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="settings-section" data-section="about">
      <h4>Informazioni</h4>
      
      <div class="settings-group">
        <div class="about-info">
          <div class="game-logo">‚öΩ Bolt Manager 01/02</div>
          <div class="game-version">Versione 1.0.0</div>
          <div class="game-copyright">¬© 2025 Bolt.new</div>
          
          <div class="about-description">
            <p>Un gioco manageriale calcistico moderno, ispirato ai classici del genere.</p>
            <p>Creato interamente con Bolt.new.</p>
          </div>
          
          <div class="about-links">
            <a href="#" class="about-link">Sito Web</a>
            <a href="#" class="about-link">Supporto</a>
            <a href="#" class="about-link">Licenza</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="panel-footer">
    <div class="unsaved-changes" style="display: none;">
      <span class="changes-indicator">‚ö†Ô∏è</span>
      <span class="changes-text">Modifiche non salvate</span>
    </div>
    
    <div class="footer-actions">
      <button class="button button-ghost cancel-btn">
        Annulla
      </button>
      <button class="button button-primary apply-btn">
        Applica Impostazioni
      </button>
    </div>
  </div>
  
  <!-- Sponsor slot -->
  <div class="sponsor-slot sponsor-slot-settings">
    <img src="https://images.pexels.com/photos/163064/play-stone-network-networked-interactive-163064.jpeg?auto=compress&cs=tinysrgb&w=200&h=40" 
         alt="Settings Sponsor" class="sponsor-image">
  </div>
</div>

<style>
.settings-panel {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  position: relative;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.panel-title {
  font-size: 18px;
  font-weight: 600;
  margin: 0;
  color: var(--text);
}

.panel-actions {
  display: flex;
  gap: 8px;
}

.action-btn {
  padding: 6px 12px;
  background: var(--background);
  border: 1px solid var(--border);
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.action-btn:hover {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.settings-container {
  margin-bottom: 20px;
}

.settings-section {
  display: none;
}

.settings-section.active {
  display: block;
}

.settings-section h4 {
  font-size: 18px;
  font-weight: 600;
  margin: 0 0 16px 0;
  color: var(--text);
}

.settings-group {
  background: var(--background);
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 20px;
}

.settings-group h5 {
  font-size: 14px;
  font-weight: 600;
  margin: 0 0 12px 0;
  color: var(--text);
}

.setting-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0;
  border-bottom: 1px solid var(--border);
}

.setting-item:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.setting-info {
  flex: 1;
  padding-right: 16px;
}

.setting-label {
  display: block;
  font-size: 14px;
  font-weight: 500;
  color: var(--text);
  margin-bottom: 4px;
}

.setting-description {
  font-size: 12px;
  color: var(--text-muted);
}

.setting-control {
  display: flex;
  align-items: center;
  gap: 8px;
}

.setting-select {
  padding: 8px 12px;
  border: 1px solid var(--border);
  border-radius: 6px;
  background: var(--surface);
  font-size: 13px;
  min-width: 120px;
}

.setting-slider {
  width: 120px;
  height: 6px;
  background: var(--border);
  border-radius: 3px;
  outline: none;
  -webkit-appearance: none;
}

.setting-slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--primary);
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.setting-slider::-moz-range-thumb {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--primary);
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.slider-value {
  font-size: 12px;
  font-weight: 500;
  color: var(--text);
  min-width: 40px;
  text-align: right;
}

.toggle-switch {
  position: relative;
  display: inline-block;
  width: 44px;
  height: 24px;
}

.toggle-switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.toggle-slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--border);
  transition: .4s;
  border-radius: 24px;
}

.toggle-slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: .4s;
  border-radius: 50%;
}

input:checked + .toggle-slider {
  background-color: var(--primary);
}

input:checked + .toggle-slider:before {
  transform: translateX(20px);
}

.about-info {
  text-align: center;
  padding: 20px 0;
}

.game-logo {
  font-size: 24px;
  font-weight: 700;
  margin-bottom: 8px;
  color: var(--primary);
}

.game-version {
  font-size: 14px;
  color: var(--text);
  margin-bottom: 4px;
}

.game-copyright {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 16px;
}

.about-description {
  margin-bottom: 16px;
}

.about-description p {
  font-size: 14px;
  color: var(--text);
  margin: 0 0 8px 0;
}

.about-links {
  display: flex;
  justify-content: center;
  gap: 16px;
}

.about-link {
  color: var(--primary);
  text-decoration: none;
  font-size: 14px;
  font-weight: 500;
}

.about-link:hover {
  text-decoration: underline;
}

.panel-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 16px;
  border-top: 1px solid var(--border);
}

.unsaved-changes {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--warning);
  font-size: 14px;
}

.footer-actions {
  display: flex;
  gap: 12px;
}

.button {
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.button-ghost {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--text);
}

.button-ghost:hover {
  background: var(--background);
}

.button-primary {
  background: var(--primary);
  border: 1px solid var(--primary);
  color: white;
}

.button-primary:hover {
  background: var(--primary-dark);
}

.button-secondary {
  background: var(--secondary);
  border: 1px solid var(--secondary);
  color: white;
}

.button-secondary:hover {
  background: #059669;
}

.button-warning {
  background: var(--warning);
  border: 1px solid var(--warning);
  color: white;
}

.button-warning:hover {
  background: #d97706;
}

.sponsor-slot-settings {
  position: absolute;
  bottom: 16px;
  right: 16px;
  width: 120px;
  height: 25px;
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--border);
  opacity: 0.8;
}

/* Responsive */
@media (max-width: 768px) {
  .panel-header {
    flex-direction: column;
    gap: 12px;
    align-items: flex-start;
  }
  
  .panel-actions {
    width: 100%;
    justify-content: space-between;
  }
  
  .setting-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .setting-info {
    padding-right: 0;
  }
  
  .setting-control {
    align-self: flex-end;
  }
  
  .panel-footer {
    flex-direction: column;
    gap: 12px;
  }
  
  .footer-actions {
    width: 100%;
    justify-content: space-between;
  }
  
  .sponsor-slot-settings {
    position: static;
    width: 100%;
    margin-top: 16px;
  }
}
</style>

<script>
class SettingsPanel {
  constructor(element, options = {}) {
    this.element = element;
    this.options = {
      onSave: null,
      onReset: null,
      onCancel: null,
      defaultSettings: {},
      ...options
    };
    
    this.currentSection = 'general';
    this.originalSettings = {};
    this.currentSettings = {};
    this.hasChanges = false;
    
    this.init();
  }
  
  init() {
    this.loadSettings();
    this.bindEvents();
    this.setActiveSection(this.currentSection);
  }
  
  loadSettings() {
    // In a real app, this would load from localStorage or game state
    try {
      const savedSettings = localStorage.getItem('bolt_settings');
      if (savedSettings) {
        this.originalSettings = JSON.parse(savedSettings);
      } else {
        this.originalSettings = { ...this.options.defaultSettings };
      }
      
      this.currentSettings = { ...this.originalSettings };
      this.applySettingsToUI();
    } catch (error) {
      console.error('Error loading settings:', error);
      this.originalSettings = { ...this.options.defaultSettings };
      this.currentSettings = { ...this.originalSettings };
    }
  }
  
  applySettingsToUI() {
    // Apply settings to UI controls
    Object.entries(this.currentSettings).forEach(([key, value]) => {
      const control = this.element.querySelector(`#${key}`);
      if (!control) return;
      
      if (control.type === 'checkbox') {
        control.checked = value;
      } else if (control.type === 'range') {
        control.value = value;
        const valueDisplay = control.nextElementSibling;
        if (valueDisplay && valueDisplay.classList.contains('slider-value')) {
          valueDisplay.textContent = `${value}%`;
        }
      } else {
        control.value = value;
      }
    });
  }
  
  bindEvents() {
    // Settings inputs
    this.element.querySelectorAll('input, select').forEach(input => {
      if (input.type === 'checkbox') {
        input.addEventListener('change', () => {
          this.updateSetting(input.id, input.checked);
        });
      } else if (input.type === 'range') {
        input.addEventListener('input', () => {
          const value = parseInt(input.value);
          this.updateSetting(input.id, value);
          
          // Update value display
          const valueDisplay = input.nextElementSibling;
          if (valueDisplay && valueDisplay.classList.contains('slider-value')) {
            valueDisplay.textContent = `${value}%`;
          }
        });
      } else {
        input.addEventListener('change', () => {
          this.updateSetting(input.id, input.value);
        });
      }
    });
    
    // Reset button
    this.element.querySelector('.reset-btn').addEventListener('click', () => {
      this.resetCurrentSection();
    });
    
    // Save button
    this.element.querySelector('.save-btn').addEventListener('click', () => {
      this.saveSettings();
    });
    
    // Cancel button
    this.element.querySelector('.cancel-btn').addEventListener('click', () => {
      this.cancel();
    });
    
    // Apply button
    this.element.querySelector('.apply-btn').addEventListener('click', () => {
      this.applySettings();
    });
    
    // Export settings button
    this.element.querySelector('.export-settings-btn').addEventListener('click', () => {
      this.exportSettings();
    });
    
    // Import settings button
    this.element.querySelector('.import-settings-btn').addEventListener('click', () => {
      this.importSettings();
    });
    
    // Reset all button
    this.element.querySelector('.reset-all-btn').addEventListener('click', () => {
      this.resetAllSettings();
    });
  }
  
  setActiveSection(section) {
    this.currentSection = section;
    
    // Update active section
    this.element.querySelectorAll('.settings-section').forEach(s => {
      s.classList.toggle('active', s.dataset.section === section);
    });
  }
  
  updateSetting(key, value) {
    this.currentSettings[key] = value;
    this.checkForChanges();
  }
  
  checkForChanges() {
    // Compare current settings with original settings
    this.hasChanges = false;
    
    Object.entries(this.currentSettings).forEach(([key, value]) => {
      if (this.originalSettings[key] !== value) {
        this.hasChanges = true;
      }
    });
    
    // Update UI
    this.element.querySelector('.unsaved-changes').style.display = this.hasChanges ? 'flex' : 'none';
  }
  
  resetCurrentSection() {
    // Get all inputs in current section
    const section = this.element.querySelector(`.settings-section[data-section="${this.currentSection}"]`);
    const inputs = section.querySelectorAll('input, select');
    
    // Reset inputs to original values
    inputs.forEach(input => {
      const key = input.id;
      const originalValue = this.originalSettings[key];
      
      if (originalValue !== undefined) {
        if (input.type === 'checkbox') {
          input.checked = originalValue;
          this.currentSettings[key] = originalValue;
        } else if (input.type === 'range') {
          input.value = originalValue;
          this.currentSettings[key] = originalValue;
          
          // Update value display
          const valueDisplay = input.nextElementSibling;
          if (valueDisplay && valueDisplay.classList.contains('slider-value')) {
            valueDisplay.textContent = `${originalValue}%`;
          }
        } else {
          input.value = originalValue;
          this.currentSettings[key] = originalValue;
        }
      }
    });
    
    this.checkForChanges();
    this.showSuccess('Impostazioni della sezione resettate');
  }
  
  resetAllSettings() {
    if (confirm('Sei sicuro di voler reimpostare tutte le impostazioni ai valori predefiniti?')) {
      this.currentSettings = { ...this.options.defaultSettings };
      this.applySettingsToUI();
      this.checkForChanges();
      this.showSuccess('Tutte le impostazioni sono state reimpostate');
    }
  }
  
  saveSettings() {
    // Save current settings as original settings
    this.originalSettings = { ...this.currentSettings };
    
    // Save to localStorage
    localStorage.setItem('bolt_settings', JSON.stringify(this.originalSettings));
    
    // Update UI
    this.checkForChanges();
    
    // Call save callback if provided
    if (typeof this.options.onSave === 'function') {
      this.options.onSave(this.originalSettings);
    }
    
    this.showSuccess('Impostazioni salvate con successo');
  }
  
  applySettings() {
    // Apply current settings
    this.saveSettings();
    
    // Dispatch apply event
    this.element.dispatchEvent(new CustomEvent('settingsApplied', {
      detail: { settings: this.currentSettings }
    }));
  }
  
  cancel() {
    // Revert to original settings
    this.currentSettings = { ...this.originalSettings };
    this.applySettingsToUI();
    this.checkForChanges();
    
    // Call cancel callback if provided
    if (typeof this.options.onCancel === 'function') {
      this.options.onCancel();
    }
  }
  
  exportSettings() {
    const exportData = {
      settings: this.currentSettings,
      timestamp: new Date().toISOString(),
      version: '1.0.0'
    };
    
    const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `bolt-manager-settings-${new Date().toISOString().split('T')[0]}.json`;
    a.click();
    URL.revokeObjectURL(url);
    
    this.showSuccess('Impostazioni esportate con successo');
  }
  
  importSettings() {
    // Create file input
    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = '.json';
    
    fileInput.addEventListener('change', (e) => {
      if (e.target.files.length === 0) return;
      
      const file = e.target.files[0];
      const reader = new FileReader();
      
      reader.onload = (event) => {
        try {
          const importedData = JSON.parse(event.target.result);
          
          if (!importedData.settings) {
            throw new Error('File non valido');
          }
          
          // Apply imported settings
          this.currentSettings = { ...importedData.settings };
          this.applySettingsToUI();
          this.checkForChanges();
          
          this.showSuccess('Impostazioni importate con successo');
        } catch (error) {
          console.error('Error importing settings:', error);
          this.showError('Errore nell\'importazione delle impostazioni');
        }
      };
      
      reader.readAsText(file);
    });
    
    fileInput.click();
  }
  
  showSuccess(message) {
    window.dispatchEvent(new CustomEvent('showToast', {
      detail: { message, type: 'success' }
    }));
  }
  
  showError(message) {
    window.dispatchEvent(new CustomEvent('showToast', {
      detail: { message, type: 'error' }
    }));
  }
  
  // Public methods
  setSection(section) {
    this.setActiveSection(section);
  }
  
  getSettings() {
    return { ...this.currentSettings };
  }
  
  setSettings(settings) {
    this.currentSettings = { ...settings };
    this.applySettingsToUI();
    this.checkForChanges();
  }
  
  hasUnsavedChanges() {
    return this.hasChanges;
  }
  
  getSetting(key) {
    return this.currentSettings[key];
  }
  
  setSetting(key, value) {
    this.currentSettings[key] = value;
    
    // Update UI control
    const control = this.element.querySelector(`#${key}`);
    if (control) {
      if (control.type === 'checkbox') {
        control.checked = value;
      } else if (control.type === 'range') {
        control.value = value;
        const valueDisplay = control.nextElementSibling;
        if (valueDisplay && valueDisplay.classList.contains('slider-value')) {
          valueDisplay.textContent = `${value}%`;
        }
      } else {
        control.value = value;
      }
    }
    
    this.checkForChanges();
  }
}

// Auto-initialize settings panels
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.settings-panel').forEach(panel => {
    if (!panel.dataset.initialized) {
      const options = JSON.parse(panel.dataset.options || '{}');
      new SettingsPanel(panel, options);
      panel.dataset.initialized = 'true';
    }
  });
});
</script>