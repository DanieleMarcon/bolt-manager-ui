<div class="staff-overview-card card">
  <div class="staff-header">
    <h3 class="staff-title">Panoramica Staff</h3>
    <div class="staff-actions">
      <button class="action-btn hire-staff-btn" aria-label="Assumi nuovo staff">
        üë• Assumi
      </button>
      <button class="action-btn manage-staff-btn" aria-label="Gestisci staff">
        ‚öôÔ∏è Gestisci
      </button>
    </div>
  </div>
  
  <div class="staff-summary">
    <div class="summary-item">
      <span class="summary-value staff-count">0</span>
      <span class="summary-label">Membri Staff</span>
    </div>
    <div class="summary-item">
      <span class="summary-value staff-budget">‚Ç¨0</span>
      <span class="summary-label">Budget Staff</span>
    </div>
    <div class="summary-item">
      <span class="summary-value staff-quality">0</span>
      <span class="summary-label">Qualit√† Media</span>
    </div>
  </div>
  
  <div class="staff-categories">
    <div class="category-item">
      <div class="category-header">
        <h4 class="category-title">Staff Tecnico</h4>
        <span class="category-count">0/0</span>
      </div>
      <div class="category-quality">
        <div class="quality-bar">
          <div class="quality-fill technical-fill"></div>
        </div>
        <span class="quality-value technical-value">0%</span>
      </div>
    </div>
    
    <div class="category-item">
      <div class="category-header">
        <h4 class="category-title">Staff Medico</h4>
        <span class="category-count">0/0</span>
      </div>
      <div class="category-quality">
        <div class="quality-bar">
          <div class="quality-fill medical-fill"></div>
        </div>
        <span class="quality-value medical-value">0%</span>
      </div>
    </div>
    
    <div class="category-item">
      <div class="category-header">
        <h4 class="category-title">Osservatori</h4>
        <span class="category-count">0/0</span>
      </div>
      <div class="category-quality">
        <div class="quality-bar">
          <div class="quality-fill scouting-fill"></div>
        </div>
        <span class="quality-value scouting-value">0%</span>
      </div>
    </div>
  </div>
  
  <div class="staff-bonuses">
    <h4>Bonus Staff Attivi</h4>
    <div class="bonuses-list">
      <div class="bonus-item">
        <div class="bonus-icon">üí™</div>
        <div class="bonus-content">
          <div class="bonus-title">Recupero Fisico</div>
          <div class="bonus-value">+15%</div>
        </div>
      </div>
      
      <div class="bonus-item">
        <div class="bonus-icon">üè•</div>
        <div class="bonus-content">
          <div class="bonus-title">Riduzione Infortuni</div>
          <div class="bonus-value">+10%</div>
        </div>
      </div>
      
      <div class="bonus-item">
        <div class="bonus-icon">üß†</div>
        <div class="bonus-content">
          <div class="bonus-title">Efficacia Allenamento</div>
          <div class="bonus-value">+12%</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Sponsor slot -->
  <div class="sponsor-slot sponsor-slot-staff">
    <img src="https://images.pexels.com/photos/163064/play-stone-network-networked-interactive-163064.jpeg?auto=compress&cs=tinysrgb&w=200&h=40" 
         alt="Staff Sponsor" class="sponsor-image">
  </div>
</div>

<style>
.staff-overview-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 20px;
  position: relative;
}

.staff-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.staff-title {
  font-size: 18px;
  font-weight: 600;
  margin: 0;
  color: var(--text);
}

.staff-actions {
  display: flex;
  gap: 8px;
}

.action-btn {
  padding: 6px 12px;
  background: var(--background);
  border: 1px solid var(--border);
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 500;
  transition: all 0.2s ease;
}

.action-btn:hover {
  background: var(--primary);
  color: white;
  border-color: var(--primary);
}

.staff-summary {
  display: flex;
  justify-content: space-around;
  gap: 16px;
  margin-bottom: 20px;
  padding: 16px;
  background: var(--background);
  border-radius: 8px;
}

.summary-item {
  text-align: center;
}

.summary-value {
  display: block;
  font-size: 20px;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 4px;
}

.summary-label {
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
}

.staff-categories {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 20px;
}

.category-item {
  background: var(--background);
  border-radius: 8px;
  padding: 12px;
}

.category-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.category-title {
  font-size: 14px;
  font-weight: 600;
  margin: 0;
  color: var(--text);
}

.category-count {
  font-size: 12px;
  color: var(--text-muted);
  font-weight: 500;
}

.category-quality {
  display: flex;
  align-items: center;
  gap: 12px;
}

.quality-bar {
  flex: 1;
  height: 8px;
  background: var(--border);
  border-radius: 4px;
  overflow: hidden;
}

.quality-fill {
  height: 100%;
  border-radius: 4px;
  transition: width 0.8s ease;
}

.technical-fill {
  background: linear-gradient(90deg, #3b82f6, #2563eb);
}

.medical-fill {
  background: linear-gradient(90deg, #10b981, #059669);
}

.scouting-fill {
  background: linear-gradient(90deg, #8b5cf6, #7c3aed);
}

.quality-value {
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  min-width: 40px;
  text-align: right;
}

.staff-bonuses {
  background: var(--background);
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 16px;
}

.staff-bonuses h4 {
  font-size: 14px;
  font-weight: 600;
  margin: 0 0 12px 0;
  color: var(--text);
}

.bonuses-list {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.bonus-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px;
  background: var(--surface);
  border-radius: 6px;
}

.bonus-icon {
  font-size: 16px;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--primary);
  color: white;
  border-radius: 6px;
  flex-shrink: 0;
}

.bonus-content {
  flex: 1;
}

.bonus-title {
  font-size: 12px;
  font-weight: 500;
  color: var(--text);
  margin-bottom: 2px;
}

.bonus-value {
  font-size: 12px;
  font-weight: 600;
  color: var(--success);
}

.sponsor-slot-staff {
  position: absolute;
  bottom: 16px;
  right: 16px;
  width: 120px;
  height: 25px;
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--border);
  opacity: 0.8;
}

/* Responsive */
@media (max-width: 1024px) {
  .bonuses-list {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .staff-header {
    flex-direction: column;
    gap: 12px;
    align-items: flex-start;
  }
  
  .staff-actions {
    width: 100%;
    justify-content: space-between;
  }
  
  .staff-summary {
    flex-direction: column;
    gap: 12px;
    align-items: center;
  }
  
  .bonuses-list {
    grid-template-columns: 1fr;
  }
  
  .sponsor-slot-staff {
    position: static;
    width: 100%;
    margin-top: 16px;
  }
}
</style>

<script>
class StaffOverviewCard {
  constructor(element, staffData) {
    this.element = element;
    this.staffData = staffData;
    this.init();
  }
  
  init() {
    this.render();
    this.bindEvents();
    this.animateBars();
  }
  
  render() {
    const data = this.staffData;
    
    // Update summary
    this.element.querySelector('.staff-count').textContent = data.totalStaff || 0;
    this.element.querySelector('.staff-budget').textContent = this.formatCurrency(data.budget || 0);
    this.element.querySelector('.staff-quality').textContent = data.averageQuality || 0;
    
    // Update categories
    this.updateCategory('technical', data.technical);
    this.updateCategory('medical', data.medical);
    this.updateCategory('scouting', data.scouting);
    
    // Update bonuses
    this.updateBonuses(data.bonuses);
  }
  
  updateCategory(category, data) {
    if (!data) return;
    
    const count = this.element.querySelector(`.${category}-count`);
    const fill = this.element.querySelector(`.${category}-fill`);
    const value = this.element.querySelector(`.${category}-value`);
    
    if (count) count.textContent = `${data.current || 0}/${data.max || 0}`;
    if (fill) fill.style.width = `${data.quality || 0}%`;
    if (value) value.textContent = `${data.quality || 0}%`;
  }
  
  updateBonuses(bonuses) {
    if (!bonuses || bonuses.length === 0) return;
    
    const bonusesList = this.element.querySelector('.bonuses-list');
    bonusesList.innerHTML = '';
    
    bonuses.forEach(bonus => {
      const bonusElement = document.createElement('div');
      bonusElement.className = 'bonus-item';
      
      bonusElement.innerHTML = `
        <div class="bonus-icon">${this.getBonusIcon(bonus.type)}</div>
        <div class="bonus-content">
          <div class="bonus-title">${bonus.name}</div>
          <div class="bonus-value">${bonus.value}</div>
        </div>
      `;
      
      bonusesList.appendChild(bonusElement);
    });
  }
  
  getBonusIcon(type) {
    const icons = {
      fitness: 'üí™',
      injury: 'üè•',
      training: 'üß†',
      morale: 'üòä',
      scouting: 'üîç',
      youth: 'üë∂',
      tactics: 'üìã'
    };
    return icons[type] || '‚≠ê';
  }
  
  formatCurrency(amount) {
    return new Intl.NumberFormat('it-IT', {
      style: 'currency',
      currency: 'EUR',
      maximumFractionDigits: 0
    }).format(amount);
  }
  
  animateBars() {
    setTimeout(() => {
      this.element.querySelectorAll('.quality-fill').forEach(fill => {
        fill.style.transition = 'width 1s ease-out';
      });
    }, 100);
  }
  
  bindEvents() {
    // Hire staff button
    this.element.querySelector('.hire-staff-btn').addEventListener('click', () => {
      this.openHireStaffModal();
    });
    
    // Manage staff button
    this.element.querySelector('.manage-staff-btn').addEventListener('click', () => {
      this.openManageStaffPage();
    });
    
    // Bonus items hover
    this.element.querySelectorAll('.bonus-item').forEach(item => {
      item.addEventListener('mouseenter', () => {
        item.style.transform = 'translateY(-2px)';
        item.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
      });
      
      item.addEventListener('mouseleave', () => {
        item.style.transform = '';
        item.style.boxShadow = '';
      });
    });
  }
  
  openHireStaffModal() {
    window.dispatchEvent(new CustomEvent('openHireStaffModal'));
  }
  
  openManageStaffPage() {
    window.dispatchEvent(new CustomEvent('navigateToStaffManagement'));
  }
  
  // Public methods
  updateStaffData(newData) {
    this.staffData = { ...this.staffData, ...newData };
    this.render();
  }
  
  getStaffData() {
    return { ...this.staffData };
  }
  
  getStaffBonuses() {
    return this.staffData.bonuses || [];
  }
  
  getStaffQuality() {
    return this.staffData.averageQuality || 0;
  }
}

// Auto-initialize staff overview cards
document.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('.staff-overview-card').forEach(card => {
    if (!card.dataset.initialized) {
      const staffData = JSON.parse(card.dataset.staffData || '{}');
      new StaffOverviewCard(card, staffData);
      card.dataset.initialized = 'true';
    }
  });
});
</script>